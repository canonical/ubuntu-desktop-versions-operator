type: charm
name: ubuntu-desktop-versions-operator
title: Ubuntu Desktop Versions
subordinate: true
summary: A simple service to check if Ubuntu packages are up to date.
description: |
  A simple service to check if Ubuntu packages are up to date.

base: ubuntu@22.04
platforms:
  amd64:
  arm64:

requires:
  apache-website:
    interface: apache-website
    scope: container

parts:
  charm:
    plugin: uv
    source: .
    build-packages:
      - git
    build-snaps:
      - astral-uv
    override-build: |
      craftctl default
      git describe --always > $CRAFT_PART_INSTALL/version

charm-libs:
  - lib: operator_libs_linux.apt
    version: "0"

config:
  options:
    domain:
      type: string
      default: "localhost"
      description: Domain name for the versions website
    port:
      type: int
      default: 80
      description: Port for the versions website

actions:
  generate-versions-report:
    description: |
      Manually trigger generation of package version comparison reports.
